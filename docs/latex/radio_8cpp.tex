\hypertarget{radio_8cpp}{}\section{radio.\+cpp File Reference}
\label{radio_8cpp}\index{radio.\+cpp@{radio.\+cpp}}


Radio implementation file.  


{\ttfamily \#include \char`\"{}radio.\+h\char`\"{}}\newline
{\ttfamily \#include $<$S\+P\+I.\+h$>$}\newline
{\ttfamily \#include $<$n\+R\+F24\+L01.\+h$>$}\newline
{\ttfamily \#include $<$R\+F24.\+h$>$}\newline
{\ttfamily \#include $<$Arduino.\+h$>$}\newline
{\ttfamily \#include $<$Arduino\+Json.\+h$>$}\newline
{\ttfamily \#include $<$Base64.\+h$>$}\newline
{\ttfamily \#include \char`\"{}sensors\+\_\+pinout.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}model.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}aes.\+h\char`\"{}}\newline
Include dependency graph for radio.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{radio_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group___radio__module_gaa445a79fc0f7373036c72d198e51f19a}{C\+TR}}~1
\begin{DoxyCompactList}\small\item\em Enable/\+Disable aes C\+TR mode. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group___radio__module_gaf0e9fea2a1fefbbf655ad908e653fa37}{R\+A\+D\+I\+O\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+TS}}~192
\begin{DoxyCompactList}\small\item\em Aes key length \mbox{[} $bits$\mbox{]}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group___radio__module_ga2e4ba70a12e464d5b5278c18d28355f8}{J\+S\+O\+N\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+ZE}}~J\+S\+O\+N\+\_\+\+O\+B\+J\+E\+C\+T\+\_\+\+S\+I\+ZE(2) + 3 $\ast$ J\+S\+O\+N\+\_\+\+O\+B\+J\+E\+C\+T\+\_\+\+S\+I\+ZE(4) + J\+S\+O\+N\+\_\+\+O\+B\+J\+E\+C\+T\+\_\+\+S\+I\+ZE(5) + 219
\begin{DoxyCompactList}\small\item\em Size of static buffer for J\+S\+ON serialization, generated by \href{https://arduinojson.org/assistant/}{\tt https\+://arduinojson.\+org/assistant/}. Model serialization format\+: \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group___radio__module_gae634b89476ef10a9d21eacb0da28cd7b}{C\+I\+P\+H\+E\+R\+\_\+\+M\+A\+X\+\_\+\+L\+E\+N\+G\+TH}}~1024
\begin{DoxyCompactList}\small\item\em Cipher buffer max length (according to \href{https://arduinojson.org/assistant/}{\tt https\+://arduinojson.\+org/assistant/}). \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group___radio__module_ga35dc4d7d23c1b86227ceb68e6ebc4fc2}{I\+V\+\_\+\+L\+EN}}~A\+E\+S\+\_\+\+K\+E\+Y\+L\+EN
\begin{DoxyCompactList}\small\item\em Initialization Vector length. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
R\+F24 \mbox{\hyperlink{group___radio__module_gab473f61dd66af21e8f24b4b95dca0222}{radio}} (R\+A\+D\+I\+O\+\_\+\+C\+E\+\_\+\+P\+IN, R\+A\+D\+I\+O\+\_\+\+C\+S\+N\+\_\+\+P\+IN)
\begin{DoxyCompactList}\small\item\em Radio. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_ga42ee2daa57d1e88e4ca6c712dba5039a}{encrypt\+\_\+model}} (char $\ast$buffer, char $\ast$\mbox{\hyperlink{group___radio__module_ga352378cd7d5875f33dece696475cb8d4}{iv}}, uint16\+\_\+t plain\+\_\+len, uint16\+\_\+t buffer\+\_\+len)
\begin{DoxyCompactList}\small\item\em Encrypt model for transmit over radio. \end{DoxyCompactList}\item 
volatile char \mbox{\hyperlink{group___radio__module_ga7eb1db79bc6e9408f447ffdc65c09aaa}{generate\+\_\+random\+\_\+char}} ()
\begin{DoxyCompactList}\small\item\em Generate a Cryptgraphically secure pseudorandom number from T\+R\+NG hardware peripheral. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_ga8d208a46c01313ddc1320256e3ce607d}{generate\+\_\+iv}} (char $\ast$buffer, uint16\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Generate a randomized initialization vector. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_gad2c532e768a8351b48ffcc95dc56e912}{pkcs7\+\_\+padding}} (char $\ast$buffer, uint16\+\_\+t plain\+\_\+len, uint16\+\_\+t buffer\+\_\+len)
\begin{DoxyCompactList}\small\item\em Perform P\+K\+C\+S7 padding described in R\+FC 5652. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_ga2cca2e5e5a5f34888f1801e752c29eb3}{byte\+\_\+padding}} (char $\ast$buffer, uint16\+\_\+t plain\+\_\+len, uint16\+\_\+t buffer\+\_\+len)
\begin{DoxyCompactList}\small\item\em Perform I\+S\+O/\+I\+EC 7816-\/4 byte padding. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_gaaf9aff6a522103cc312457043baf7eca}{radio\+\_\+init}} ()
\begin{DoxyCompactList}\small\item\em Initialize T\+R\+NG (True Random Number Generator) hardware peripheral as a C\+S\+P\+R\+NG (Cryptographically Secure Pseudo-\/\+Random Number Generator) for generate randomized IV. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___radio__module_ga5250a82de95a2d4e497dd1c580a92362}{radio\+\_\+send\+\_\+model}} ()
\begin{DoxyCompactList}\small\item\em Actions performed involve\+: \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile bool \mbox{\hyperlink{group___radio__module_gaaebbe13533cac0f28446c13ae32b1cb2}{radio\+\_\+transmit}} = false
\begin{DoxyCompactList}\small\item\em Radio transmit enable flag. \end{DoxyCompactList}\item 
char \mbox{\hyperlink{group___radio__module_gae0c804caa6b80b155884dc4f7a2d9da3}{key}} \mbox{[}A\+E\+S\+\_\+\+K\+E\+Y\+L\+EN\mbox{]}
\begin{DoxyCompactList}\small\item\em A\+ES encryption K\+EY. \end{DoxyCompactList}\item 
char \mbox{\hyperlink{group___radio__module_ga352378cd7d5875f33dece696475cb8d4}{iv}} \mbox{[}\mbox{\hyperlink{group___radio__module_ga35dc4d7d23c1b86227ceb68e6ebc4fc2}{I\+V\+\_\+\+L\+EN}}+1\mbox{]}
\begin{DoxyCompactList}\small\item\em A\+ES encryption Initialization Vector. \end{DoxyCompactList}\item 
char \mbox{\hyperlink{group___radio__module_ga4372a894c9299a437425452130748eb8}{cipher}} \mbox{[}\mbox{\hyperlink{group___radio__module_gae634b89476ef10a9d21eacb0da28cd7b}{C\+I\+P\+H\+E\+R\+\_\+\+M\+A\+X\+\_\+\+L\+E\+N\+G\+TH}}+1\mbox{]} = \{0\}
\begin{DoxyCompactList}\small\item\em Encrypted model buffer. \end{DoxyCompactList}\item 
const uint64\+\_\+t \mbox{\hyperlink{group___radio__module_gafe30685f23b8cbf122ddec37280ba8e4}{pipe}} = 0x\+E8\+E8\+F0\+F0\+E1\+LL
\begin{DoxyCompactList}\small\item\em Radio writing pipe. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Radio implementation file. 

\begin{DoxyAuthor}{Author}
Arella Matteo ~\newline
 (mail\+: \href{mailto:arella.1646983@studenti.uniroma1.it}{\tt arella.\+1646983@studenti.\+uniroma1.\+it}) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2018 
\end{DoxyDate}
